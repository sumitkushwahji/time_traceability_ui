<div class="min-h-screen bg-slate-100 p-4">
  <div class="bg-white rounded-2xl shadow-lg p-4 overflow-auto">
    <h1 class="text-lg font-semibold mb-4 text-slate-700">Pivoted Data View</h1>

    <!-- Controls -->
    <div class="flex flex-col md:flex-row justify-between items-center gap-4 mb-4">
      <div class="flex items-center gap-4 text-sm">
        <div class="flex items-center gap-2">
          <label for="startDate" class="font-medium text-slate-600">Start Date:</label>
          <input type="datetime-local" id="startDate" [(ngModel)]="startDate" (change)="onDateRangeChange()" class="border rounded px-2 py-1 shadow-sm">
        </div>
        <div class="flex items-center gap-2">
          <label for="endDate" class="font-medium text-slate-600">End Date:</label>
          <input type="datetime-local" id="endDate" [(ngModel)]="endDate" (change)="onDateRangeChange()" class="border rounded px-2 py-1 shadow-sm">
        </div>
      </div>
      <div class="text-sm text-gray-600">
        <span class="font-medium">{{ totalItems }}</span> total records
        <span *ngIf="selectedFilter !== 'ALL'" class="text-blue-600 ml-1">
          ({{ selectedFilter }} filtered)
        </span>
      </div>
    </div>

    <!-- Loading Indicator -->
    <div *ngIf="isLoading" class="flex justify-center items-center py-8">
      <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"></div>
    </div>

    <!-- Data Table -->
    <div *ngIf="!isLoading" class="overflow-x-auto rounded-lg border border-gray-200">
      <table class="min-w-full text-xs text-slate-800">
        <thead class="bg-slate-100 text-slate-600 text-left">
          <tr>
            <th class="p-2 sticky left-0 bg-slate-100 z-10">Satellite</th>
            <th class="p-2">MJD</th>
            <th class="p-2">MJD DateTime</th>
            <th class="p-2">STTime</th>
            <th *ngFor="let col of dynamicColumns" class="p-2 text-center">{{ col }}</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let row of pivotedData" class="hover:bg-slate-50 border-b">
            <td class="p-2 sticky left-0 bg-white z-10 font-semibold">{{ row.satLetter }}</td>
            <td class="p-2">{{ row.mjd }}</td>
            <td class="p-2">{{ row.mjdDateTime | date:'medium':'Asia/Kolkata' }}</td>
            <td class="p-2">{{ row.sttime }}</td>
            <td *ngFor="let col of dynamicColumns" class="p-2 text-center">
              {{ row.locationDiffs[col] ?? '-' }}
            </td>
          </tr>
        </tbody>
      </table>
      <div *ngIf="!isLoading && pivotedData.length === 0" class="text-center py-8 text-gray-500">
        No data available for the selected filters.
      </div>
    </div>

    <!-- Pagination -->
    <div *ngIf="!isLoading && totalItems > 0" class="mt-4 flex flex-col md:flex-row items-center justify-between text-sm text-gray-600 gap-2">
        <div>
            Page <span class="font-medium">{{ currentPage }}</span> of <span class="font-medium">{{ totalPages }}</span>
        </div>
        <div class="space-x-2">
            <button (click)="onPageChange(currentPage - 1)" [disabled]="currentPage === 1" class="px-3 py-1 bg-gray-100 rounded hover:bg-gray-200 disabled:opacity-50">Previous</button>
            <button (click)="onPageChange(currentPage + 1)" [disabled]="currentPage === totalPages" class="px-3 py-1 bg-gray-100 rounded hover:bg-gray-200 disabled:opacity-50">Next</button>
        </div>
    </div>

  </div>
</div>

