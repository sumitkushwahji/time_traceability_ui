<div class="p-4">
  <div class="flex items-center justify-between mb-4">
    <h2 class="text-xl font-semibold">Common View Time Transfer Link</h2>
    <button 
      (click)="downloadPlot()" 
      class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded ml-4"
      [disabled]="!chartData || filteredData.length === 0"
    >
      Download Plot
    </button>
  </div>

  <!-- Show Last + Date Filters in same line -->
  <div class="flex flex-wrap items-center gap-4 mb-4">
    <div class="flex items-center gap-2">
      <label>Show last:</label>
      <select [(ngModel)]="dataLimit" (change)="updateChartData()" class="border px-2 py-1">
        <option *ngFor="let limit of dataLimits" [value]="limit">
          {{ limit === -1 ? 'All' : limit }}
        </option>
      </select>
    </div>

    <div class="flex items-center gap-2">
      <label>Start Date:</label>
      <input type="date" [(ngModel)]="startDate" (change)="applyFilter(filterService.getCurrentFilter())" class="border px-2 py-1">
    </div>

    <div class="flex items-center gap-2">
      <label>End Date:</label>
      <input type="date" [(ngModel)]="endDate" (change)="applyFilter(filterService.getCurrentFilter())" class="border px-2 py-1">
    </div>
  </div>

  <!-- Chart -->
  <ng-container *ngIf="isBrowser; else ssrFallback">
    <canvas baseChart
            [data]="chartData"
            [options]="chartOptions"
            [type]="'line'">
    </canvas>
  </ng-container>

  <ng-template #ssrFallback>
    <p class="text-gray-500 italic">Chart is not available during server-side rendering.</p>
  </ng-template>

  <!-- No Data Message -->
  <div *ngIf="!filteredData || filteredData.length === 0" class="text-gray-500 mt-4">
    No data available for selected filter/date
  </div>
</div>
